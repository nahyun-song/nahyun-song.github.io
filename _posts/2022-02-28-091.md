---
layout: single
title:  "20220228 week2-1"
categories: preonboarding
---

# Week2-1 / Pytorch Tutorial (1)

1. tensor ìƒì„±
    - `torch` : í…ì„œë¥¼ ìƒì„±í•˜ëŠ” ë¼ì´ë¸ŒëŸ¬ë¦¬
    - `torch.autograd` : ìë™ë¯¸ë¶„ ê¸°ëŠ¥ì„ ì œê³µí•˜ëŠ” ë¼ì´ë¸ŒëŸ¬ë¦¬
    - `torch.nn` : ì‹ ê²½ë§ì„ ìƒì„±í•˜ëŠ” ë¼ì´ë¸ŒëŸ¬ë¦¬
    - `torch.multiprocessing` : ë³‘ë ¬ì²˜ë¦¬ ê¸°ëŠ¥ì„ ì œê³µí•˜ëŠ” ë¼ì´ë¸ŒëŸ¬ë¦¬
    - `torch.utils` : ë°ì´í„° ì¡°ì‘ ë“± ìœ í‹¸ë¦¬í‹° ê¸°ëŠ¥ ì œê³µ
    - `torch.legacy` : Torchë¡œë¶€í„° í¬íŒ…í•´ì˜¨ ì½”ë“œ
    - `torch.onnx` : Open Neural Network Exchange
        - ì„œë¡œ ë‹¤ë¥¸ í”„ë ˆì„ì›Œí¬ ê°„ì˜ ëª¨ë¸ì„ ê³µìœ í•  ë•Œ ì‚¬ìš©
2. tensor ì •ë³´
    - ë„˜íŒŒì´ì˜ n-dimesional arrayì™€ ìœ ì‚¬
    - GPUë¥¼ ì‚¬ìš©í•œ ì—°ì‚° ê°€ì†ë„ ê°€ëŠ¥

3. tensor ì¸ë±ì‹±
    - numpyì²˜ëŸ¼ ì¸ë±ì‹± ì‚¬ìš© ê°€ëŠ¥
    

4. tensor ì—°ì‚°
    - ë§ì…ˆ :  x+y, `torch.add(x,y)`, in-place ë°©ì‹
        - `in-place` : y += x ì™€ ê°™ì€ í˜•íƒœ. `x.copy_(y)`, `x.t_()`
    - ëº„ì…ˆ : `torch.sub`
    - ê³±ì…‰ : `torch.mul`
    - ë‚˜ëˆ—ì…ˆ : `torch.div`
    - ë‚´ì  : `torch.mm`

5. í…ì„œ êµ¬ì„± : [ë ˆì´ì–´ê°œìˆ˜, ë°°ì¹˜í¬ê¸°(ë¬¸ì¥ì˜ ê°œìˆ˜), í† í°ì˜ ê°œìˆ˜(ë¬¸ì¥ì˜ ê¸¸ì´), hidden_size(í•œ í† í°ì˜ ì°¨ì›ìˆ˜)]



```python
!pip3 install torch torchvision torchaudio
```

    Collecting torch
      Downloading torch-1.10.2-cp38-none-macosx_10_9_x86_64.whl (147.2 MB)
    [K     |â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 147.2 MB 4.1 MB/s eta 0:00:011    |â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰                  | 63.8 MB 8.3 MB/s eta 0:00:11
    [?25hCollecting torchvision
      Downloading torchvision-0.11.3-cp38-cp38-macosx_10_9_x86_64.whl (1.2 MB)
    [K     |â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1.2 MB 11.6 MB/s eta 0:00:01
    [?25hCollecting torchaudio
      Downloading torchaudio-0.10.2-cp38-cp38-macosx_10_9_x86_64.whl (2.4 MB)
    [K     |â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2.4 MB 9.7 MB/s eta 0:00:01
    [?25hRequirement already satisfied: typing-extensions in /Users/nahyunsong/opt/anaconda3/lib/python3.8/site-packages (from torch) (3.7.4.3)
    Requirement already satisfied: pillow!=8.3.0,>=5.3.0 in /Users/nahyunsong/opt/anaconda3/lib/python3.8/site-packages (from torchvision) (8.0.1)
    Requirement already satisfied: numpy in /Users/nahyunsong/opt/anaconda3/lib/python3.8/site-packages (from torchvision) (1.19.2)
    Installing collected packages: torch, torchvision, torchaudio
    Successfully installed torch-1.10.2 torchaudio-0.10.2 torchvision-0.11.3



```python
# 2. ì—°ìŠµ
import torch
```


```python
torch.__version__
```




    '1.10.2'




```python
# ì´ˆê¸°í™” ë˜ì§€ ì•Šì€ í–‰ë ¬
x = torch.empty(4, 2) #shpaeì´ 4x2ì¸ tensor ìƒì„±
print(x)
```

    tensor([[5.2286e+25, 4.5912e-41],
            [5.2581e+25, 4.5912e-41],
            [5.2985e+25, 4.5912e-41],
            [5.2547e+25, 4.5912e-41]])



```python
#ë¬´ì‘ìœ„ë¡œ ì´ˆê¸°í™”ëœ í–‰ë ¬
x = torch.rand(4,2)
print(x)
```

    tensor([[0.2214, 0.3889],
            [0.7894, 0.2470],
            [0.6957, 0.6837],
            [0.9224, 0.1818]])



```python
#dtypeì´ long(datatype), 0ìœ¼ë¡œ ì±„ì›Œì§„ í…ì„œ
x = torch.zeros(4,2,dtype=torch.long)
print(x)
```

    tensor([[0, 0],
            [0, 0],
            [0, 0],
            [0, 0]])



```python
#í…ì„œ ì§ì ‘ ë§Œë“¤ê¸°
x = torch.tensor([3, 2.3])
print(x)
```

    tensor([3.0000, 2.3000])



```python
x = x.new_ones(2,4, dtype=torch.double) #double = float64
print(x)
```

    tensor([[1., 1., 1., 1.],
            [1., 1., 1., 1.]], dtype=torch.float64)



```python
#xì˜ ëª¨ì–‘ì€ ê·¸ëŒ€ë¡œ ê°€ì ¸ì˜¤ë˜ ê°’ì€ randomìœ¼ë¡œ ì±„ì›€
x = torch.randn_like(x, dtype=torch.float)
print(x)
```

    tensor([[-0.8325, -0.3986,  0.0660,  2.4912],
            [-0.7553,  1.3947, -0.7718, -0.6213]])



```python
#í…ì„œì˜ í¬ê¸°
print(x.size())
```

    torch.Size([2, 4])



```python
#ë§ì…ˆ
y = torch.rand(2,4)
print(x+y)
```

    tensor([[-0.5721,  0.4136,  0.6276,  3.4804],
            [ 0.0536,  2.1490,  0.1260, -0.5015]])



```python
print(torch.add(x, y))
```

    tensor([[-0.5721,  0.4136,  0.6276,  3.4804],
            [ 0.0536,  2.1490,  0.1260, -0.5015]])



```python
result = torch.empty(2, 4)
torch.add(x, y, out=result)
print(result)
```

    tensor([[-0.5721,  0.4136,  0.6276,  3.4804],
            [ 0.0536,  2.1490,  0.1260, -0.5015]])



```python
print(x)
print(y)
y.add_(x)
print(y)
```

    tensor([[-0.8325, -0.3986,  0.0660,  2.4912],
            [-0.7553,  1.3947, -0.7718, -0.6213]])
    tensor([[0.2604, 0.8122, 0.5616, 0.9892],
            [0.8089, 0.7543, 0.8978, 0.1197]])
    tensor([[-0.5721,  0.4136,  0.6276,  3.4804],
            [ 0.0536,  2.1490,  0.1260, -0.5015]])



```python
# ëº„ì…ˆ
x = torch.Tensor([[1, 3],
                 [5, 7]])
y = torch.Tensor([[2, 4],
                 [6, 8]])
print(x-y)
print(torch.sub(x, y))
print(x.sub(y))
```

    tensor([[-1., -1.],
            [-1., -1.]])
    tensor([[-1., -1.],
            [-1., -1.]])
    tensor([[-1., -1.],
            [-1., -1.]])



```python
#ê³±ì…ˆ (ê° ì›ì†Œë¥¼ ê³±í•©. í–‰ë ¬ê³±X)
x = torch.Tensor([[1, 3],
                 [5, 7]])
y = torch.Tensor([[2, 4],
                 [6, 8]])
print(x*y)
print(torch.mul(x, y))
print(x.mul(y))
```

    tensor([[ 2., 12.],
            [30., 56.]])
    tensor([[ 2., 12.],
            [30., 56.]])
    tensor([[ 2., 12.],
            [30., 56.]])



```python
#ë‚˜ëˆ—ì…ˆ
x = torch.Tensor([[1, 3],
                 [5, 7]])
y = torch.Tensor([[2, 4],
                 [6, 8]])
print(x/y)
print(torch.div(x, y))
print(x.div(y))
```

    tensor([[0.5000, 0.7500],
            [0.8333, 0.8750]])
    tensor([[0.5000, 0.7500],
            [0.8333, 0.8750]])
    tensor([[0.5000, 0.7500],
            [0.8333, 0.8750]])



```python
#ë‚´ì  (í–‰ë ¬ê³±)
x = torch.Tensor([[1, 3],
                 [5, 7]])
y = torch.Tensor([[2, 4],
                 [6, 8]])
print(torch.mm(x, y))
```

    tensor([[20., 28.],
            [52., 76.]])



```python
#ì¸ë±ì‹±
print(x)
print(x[:,1])
```

    tensor([[1., 3.],
            [5., 7.]])
    tensor([3., 7.])



```python
# view - í…ì„œì˜ í¬ê¸°ë‚˜ ëª¨ì–‘ì„ ë³€ê²½
x = torch.randn(4, 5)
y = x.view(20)
z = x.view(5, -1) # -1 : ìë™

print(x)
print(y)
print(z)
```

    tensor([[ 0.6993,  0.3697,  0.1376, -0.6983,  1.2791],
            [-1.1951,  1.3451,  1.2371,  0.4501, -0.3160],
            [ 1.0536, -0.1442,  1.7443, -0.1244, -1.2180],
            [ 1.2323, -1.8784,  0.0217, -0.5873, -0.9292]])
    tensor([ 0.6993,  0.3697,  0.1376, -0.6983,  1.2791, -1.1951,  1.3451,  1.2371,
             0.4501, -0.3160,  1.0536, -0.1442,  1.7443, -0.1244, -1.2180,  1.2323,
            -1.8784,  0.0217, -0.5873, -0.9292])
    tensor([[ 0.6993,  0.3697,  0.1376, -0.6983],
            [ 1.2791, -1.1951,  1.3451,  1.2371],
            [ 0.4501, -0.3160,  1.0536, -0.1442],
            [ 1.7443, -0.1244, -1.2180,  1.2323],
            [-1.8784,  0.0217, -0.5873, -0.9292]])



```python
#item - ìŠ¤ì¹¼ë¼ ê°’ì´ í•˜ë‚˜ë§Œ ì¡´ì¬í•´ì•¼ í•¨!
x = torch.randn(1)
print(x)
print(x.item())
print(x.dtype)
```

    tensor([-0.8566])
    -0.8565942645072937
    torch.float32



```python
#squeeze - ì°¨ì› ì¶•ì†Œ (ì œê±°)
tensor = torch.rand(1, 3, 3)
print(tensor)
tensor.shape
```

    tensor([[[0.8683, 0.1970, 0.8002],
             [0.5062, 0.3201, 0.6410],
             [0.3254, 0.1921, 0.8986]]])





    torch.Size([1, 3, 3])




```python
t = tensor.squeeze()
print(t)
print(t.shape)
```

    tensor([[0.3778, 0.3723, 0.6826],
            [0.5726, 0.0437, 0.7443],
            [0.5970, 0.1065, 0.5964]])
    torch.Size([3, 3])



```python
#unsqueeze - ì°¨ì› ì¦ê°€ (ìƒì„±)
tensor = torch.rand(1, 3, 3)
print(tensor)
tensor.shape
```

    tensor([[[0.0014, 0.5739, 0.8979],
             [0.5243, 0.9613, 0.6927],
             [0.2039, 0.4004, 0.6117]]])





    torch.Size([1, 3, 3])




```python
t = tensor.unsqueeze(dim=0)
print(t)
t.shape
```

    tensor([[[[0.0014, 0.5739, 0.8979],
              [0.5243, 0.9613, 0.6927],
              [0.2039, 0.4004, 0.6117]]]])





    torch.Size([1, 1, 3, 3])




```python
#stack - í…ì„œê°„ ê²°í•©
x = torch.FloatTensor([1, 4])
y = torch.FloatTensor([2, 5])
z = torch.FloatTensor([3, 6])

print(torch.stack([x, y, z]))
```

    tensor([[1., 4.],
            [2., 5.],
            [3., 6.]])



```python
#cat : í…ì„œë¥¼ ê²°í•©í•˜ëŠ” ë©”ì„œë“œ(concatenate)
## numpyì˜ stackê³¼ ìœ ì‚¬í•˜ì§€ë§Œ, ìŒ“ì„ dimì´ ì¡´ì¬í•´ì•¼í•¨ - í•´ë‹¹ ì°¨ì›ì„ ëŠ˜ë ¤ì¤€ í›„ ê²°í•©
a = torch.randn(1, 1, 3, 3)
b = torch.randn(1, 1, 3, 3)
c = torch.cat((a, b), dim=0) #dimension : Concat ê¸°ì¤€ì !

print(c)
c.size() #dim=0ì´ê¸° ë•Œë¬¸ì— í† ì¹˜ ì‚¬ì´ì¦ˆë¥¼ ì¶œë ¥í•œ ê°’ì—ì„œ 0ë²ˆ ì¸ë±ìŠ¤ê°€ ëŠ˜ì–´ë‚œ ê²ƒì„ í™•ì¸
```

    tensor([[[[-2.0085,  1.5450,  2.2465],
              [ 1.4097, -0.4118,  0.6842],
              [ 1.5219, -0.2504, -1.4198]]],
    
    
            [[[-1.5226, -1.1809,  1.0983],
              [-0.1676, -0.8545, -0.5558],
              [-1.8932,  1.2518, -1.4177]]]])





    torch.Size([2, 1, 3, 3])




```python
#torch, numpy í˜¸í™˜ : numpy(), from_numpy()
## tensorê°€ CPUìƒì— ìˆë‹¤ë©´ numpy ë°°ì—´ì€ ë©”ëª¨ë¦¬ ê³µê°„ì„ ê³µìœ í•˜ë¯€ë¡œ í•˜ë‚˜ê°€ ë³€í•˜ë©´, ë‹¤ë¥¸ í•˜ë‚˜ë„ ë³€í•¨

a = torch.ones(7)
print(a)

```

    tensor([1., 1., 1., 1., 1., 1., 1.])



```python
b = a.numpy()
print(b)
```

    [1. 1. 1. 1. 1. 1. 1.]



```python
a.add_(1)
print(a)
b #CPUìƒì— ìˆìœ¼ë¯€ë¡œ ì„œë¡œ ê³µìœ í•˜ì—¬ ê°’ì´ ê°™ì´ ë³€í•¨
```

    tensor([2., 2., 2., 2., 2., 2., 2.])





    array([2., 2., 2., 2., 2., 2., 2.], dtype=float32)




```python
import numpy as np
a = np.ones(7)
b = torch.from_numpy(a)
np.add(a, 1, out=a)
print(a)
b
```

    [2. 2. 2. 2. 2. 2. 2.]





    tensor([2., 2., 2., 2., 2., 2., 2.], dtype=torch.float64)


